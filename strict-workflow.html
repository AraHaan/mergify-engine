
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    
    <title>Strict Merge &#8212; Mergify  documentation</title>

  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
  
    <link rel="stylesheet" href="_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/mergify.css" type="text/css" />

  
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
  <script type="text/javascript" src="_static/mergify.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous" />
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Example Rules" href="examples.html" />
    <link rel="prev" title="Commands" href="commands.html" /> 
  </head><body>
<nav class="navbar navbar-expand-lg sticky-top navbar-light bg-light flex-wrap">
  <button class="navbar-toggler ml-auto py-2" type="button" data-toggle="collapse" data-target="#exCollapsingNavbar2">
    &#9776;
  </button>
  <div class="navbar-collapse collapse" id="exCollapsingNavbar2">
    <a class="navbar-brand py-1" href="index.html">
      <img class="logo" src="_static/mergify-logo-horizontal.png" alt="Mergify"/>
    </a>
    <ul class="navbar-nav mr-auto">
      <li class="nav-item">
        <a class="nav-link" href="https://mergify.io" target="_blank">Mergify.io</a>
      </li>
      <li>
        <a class="nav-link" href="https://dashboard.mergify.io" target="_blank">Dashboard</a>
      </li>
    </ul>
    <div class="dropdown-divider d-block d-sm-none mb-4"></div>
    <form class="form-inline" action="search.html" method="get">
      <input type="text" name="q" class="form-control mr-sm-2" placeholder="Search" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
      <button class="btn btn-outline-primary my-2 my-sm-0" type="submit">Search</button>
    </form>
  </div>
</nav>
</div>
  <nav class="related d-flex justify-content-between bg-light flex-wrap" role="navigation" aria-label="related navigation">
  <ol class="breadcrumb">
    <li class="breadcrumb-item"><a href="index.html">Mergify  documentation</a></li>
    <li class="breadcrumb-item active">Strict Merge</li>
  </ol>
  <div>
    <div class="btn-group btn-group-sm" role="group" aria-label="Basic example">
      <a href="commands.html" title="Previous Chapter: Commands" class="btn btn-primary" role="button" accesskey="P">
        &laquo; Commands
      </a>
      <a href="examples.html" title="Next Chapter: Example Rules" class="btn btn-primary" role="button" accesskey="N">
        Example Rules &raquo;
      </a>
    </div>
  </div>
</nav>
  <div class="main container-fluid">
    <div class="row">
      <div class="sphinxsidebar col-md-2" aria-label="main navigation"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="getting-started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Configuration File Format</a></li>
<li class="toctree-l1"><a class="reference internal" href="conditions.html">Conditions</a></li>
<li class="toctree-l1"><a class="reference internal" href="actions.html">Actions</a></li>
<li class="toctree-l1"><a class="reference internal" href="commands.html">Commands</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Strict Merge</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#understanding-the-problem">Understanding the Problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="#the-strict-workflow-solution">The Strict Workflow Solution</a></li>
<li class="toctree-l2"><a class="reference internal" href="#enabling-the-strict-workflow">Enabling the Strict Workflow</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Example Rules</a></li>
<li class="toctree-l1"><a class="reference internal" href="badge.html">Badge</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">FAQ</a></li>
</ul>


      </div>
      <div class="document col-md-10">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="strict-merge">
<span id="id1"></span><h1>Strict Merge<a class="headerlink" href="#strict-merge" title="Permalink to this headline">¶</a></h1>
<p>The <em>strict</em> merge workflow is a workflow that prevents merging broken pull
requests. That situation can arise when outdated pull requests are being merged
in their base branch.</p>
<div class="section" id="understanding-the-problem">
<h2>Understanding the Problem<a class="headerlink" href="#understanding-the-problem" title="Permalink to this headline">¶</a></h2>
<p>To understand what the problem is, imagining the following situation: the base
branch (e.g., <code class="docutils literal notranslate"><span class="pre">master</span></code>) has its continuous integration testing passing
correctly.  A passing pull request is created then. The state of the repository
can be represented like this:</p>
<img alt="Pull request is open" src="_images/master-pr-ci-pass.png" />
<p>While the pull request stays open, another commit is pushed to <code class="docutils literal notranslate"><span class="pre">master</span></code>. That
can be a local commit or a merge commit from another pull request; who knows.
The tests are run against <code class="docutils literal notranslate"><span class="pre">master</span></code> and they pass. The state of the continuous
integration system is now reflected as this:</p>
<img alt="Base branch adds a new commit" src="_images/new-master-pr-ci-pass.png" />
<p>The pull request is still marked as valid by the continuous integration system
since it did not change. Therefore, the pull request is considered as
_mergeable_: the merge button is green.</p>
<p>If you click that merge button, this is what might happens:</p>
<img alt="Base branch is broken" src="_images/merge-ci-fail.png" />
<p>As a new merge commit is created to merge the pull request, it is possible that
the continuous integration testing will fail. Indeed: a new test might have
been added in master while the pull request was open, and that pull request may
not have the correct code to pass this new test.</p>
<p>By pressing the merge button, you just broke your continuous integration
system, and probably your software. Good work.</p>
</div>
<div class="section" id="the-strict-workflow-solution">
<h2>The Strict Workflow Solution<a class="headerlink" href="#the-strict-workflow-solution" title="Permalink to this headline">¶</a></h2>
<p>The <em>strict</em> workflow solves that issue by updating any pull request that is
not up-to-date with its base branch before being merged. That forces the
continuous integration system to test again the pull request with the new code.</p>
<p>In the previous example, the continuous integration system would have marked the
pull request as failing the test, removing it from the mergeable candidate.</p>
<img alt="Rebase make CI fails" src="_images/merge-ci-fail.png" />
<p>When the <em>strict</em> workflow is enabled, Mergify takes care of merging the target
branch in any pull request that is not up-to-date with its target branch. If
multiple pull requests are mergeable, they are scheduled to be merged
sequentially, and they will be updated on top of each other.</p>
<p>The pull request branch update is only done when the pull request is ready to
be merged by the engine, e.g., when the status checks are OK and the number of
postive reviews are enough.</p>
</div>
<div class="section" id="enabling-the-strict-workflow">
<h2>Enabling the Strict Workflow<a class="headerlink" href="#enabling-the-strict-workflow" title="Permalink to this headline">¶</a></h2>
<p>To enable the <em>strict</em> workflow, you need to set the value of <code class="docutils literal notranslate"><span class="pre">strict</span></code> to
<code class="docutils literal notranslate"><span class="pre">true</span></code> in the <a class="reference internal" href="actions.html#merge-action"><span class="std std-ref">merge</span></a> action. For example:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">pull_request_rules</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">automatic merge with strict</span>
    <span class="nt">conditions</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="s">&quot;#approved-reviews-by&gt;=2&quot;</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">status-success=continuous-integration/travis-ci/pr</span>
    <span class="nt">actions</span><span class="p">:</span>
      <span class="nt">merge</span><span class="p">:</span>
        <span class="nt">method</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">merge</span>
        <span class="nt">strict</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">true</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
    </div>
      <div class="clearer"></div>
    </div>
  </div>
<footer class="footer d-flex justify-content-between flex-wrap">
    <div class="copyright">
        <div>&copy; Copyright 2019, Mergify</div>
    </div>
    <div>
        <a href="#" class="btn btn-primary btn-sm" role="button">Back to top</a>
    </div>
</footer>
  </body>
</html>